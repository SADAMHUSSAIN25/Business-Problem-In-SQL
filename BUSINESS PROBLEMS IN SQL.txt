                     -----BUSINESS PROBLEMS 1-----
					 
--Q1. What is the total revenue generated?

select sum(sale) AS total_revenue from orders

--Q2. How many products do we have? 

select count(product_id) As Total_product from products

--Q3. find out top 5 order details by sales amount

select * from orders order by sale DESC limit 5

--Q4. what is the average order values

select Avg(sale) As Avg_order from orders

--Q5. What is a total sales for goa

select sum(sale) AS total_sales from orders where state = 'Goa'

--Q6. how many unique customer have placed orders

select  count(Distinct customer_id) from orders



                        -----BUSINESS PROBLEMS 2-----

--Q1. what is the total sales revenue generated by each state?

select sum(sale) As Total_sales ,state from orders 
where state IS NOT NULL group by 2

--Q2. how many orders were placed by each customer,
--and what is their avg order quanity?

Select customer_id,avg(quantity) As Avg_qty from orders
group by 1


--Q3. Which category has the highest avg sale amount per order

select * from orders

select category,Avg(Sale) As Highest_avg_sales from orders
where category Is NOT NULL
group by 1

--Q4 Find the top 3 products and revenue generated having revenue>30000

select product_id,sum(sale) As Revenue_generated from orders
group by 1
having sum(sale)> 30000

--Q5 Which is the best selling month in 2022 based on revenue?

select Extract(MONTH from order_date) As MONTH,
Sum(Sale) As Total_revenue
from orders 
where Extract(Year from order_date) ='2022'
group by month
order by total_revenue Desc
limit 1

--Q6. Identify the top 3 best seling product(Sub_Category)in terms of total quantity sold
 
 select sub_category,sum(quantity) from orders 
 group by 1
 limit 3
 
 
 
                           -----BUSINESS PROBLEMS 3-----
						   
--Q1. Find Customers name and total orders and total revenue?

select * from customers
select * from orders


select c.customer_name,
sum(o.sale) As Total_revenue,
count(o.order_id)As Total_orders
from orders O 
inner join customers c
on c.customer_id = O.customer_id
group by 1

--Q2. identify all orders that have been returned, along with the 
--details of retuens(if available).(LEFT JOIn)

Select * from orders o
left join returns r
on o.order_id = r.order_id

--Q3. Find all instances where products have been sold, returned,
--or both , along with the associated details.(Full join)

select * from products



                                -----BUSINESS PROBLEMS 4-----


--Q1. Find the top 5 customers based on total orders(qty) for 2022


select customer_id, sum(quantity) AS Total_order_qty
from orders
where Extract(year from order_date) = '2022'
group by 1
order by sum(quantity) desc
limit 5

--Q2. Find out best performing month of 2021 based on the total revenue generated

select Extract(Month from order_date) As Month,
sum(sale) As Total_revenue_gen
from orders
where Extract(year from order_date) = '2021'
group by Month
order by Sum(Sale) desc
